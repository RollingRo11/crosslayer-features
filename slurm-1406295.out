Traceback (most recent call last):
  File "/projects/RohanKathuria/crosslayer-features/crosscoder/simple_train.py", line 24, in main
    trainer = Trainer(config, use_wandb=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/projects/RohanKathuria/crosslayer-features/crosscoder/crosscoder.py", line 435, in __init__
    self.buffer = Buffer(cfg, model=self.model)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/projects/RohanKathuria/crosslayer-features/crosscoder/crosscoder.py", line 244, in __init__
    estimated_norm_scaling_factors = self.estimate_norm_scaling_factor(cfg["model_batch_size"])
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/projects/RohanKathuria/crosslayer-features/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/projects/RohanKathuria/crosslayer-features/crosscoder/crosscoder.py", line 261, in estimate_norm_scaling_factor
    all_tokens = self.get_tokens_for_norm_estimation(n_batches_for_norm_estimate, batch_size)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/projects/RohanKathuria/crosslayer-features/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/projects/RohanKathuria/crosslayer-features/crosscoder/crosscoder.py", line 304, in get_tokens_for_norm_estimation
    norm_dataset = self.dataset
                   ^^^^^^^^^^^^
AttributeError: 'Buffer' object has no attribute 'dataset'
--- CROSSCODER TRAINING ---
Device: cuda
Batch size: 2048
AE dimension: 32768
Total steps: 100,000
L1 coefficient: 2.5
Buffer Multiplier: 16
enc/dec init norm: 0.05

Initializing trainer...
Training failed: 'Buffer' object has no attribute 'dataset'
Could not save checkpoint
Training completed!
